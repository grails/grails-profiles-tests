install: true
jdk:
  - oraclejdk8
script:
  - curl -s get.sdkman.io | bash
  - source "$HOME/.sdkman/bin/sdkman-init.sh"
  - echo sdkman_auto_answer=true > ~/.sdkman/etc/config
  - source "/home/travis/.sdkman/bin/sdkman-init.sh"
  - ./gradlew build --console=plain
  - cd build/grails-wrapper/
  - ./gradlew assemble
  - cd ../../
  - mkdir -p $HOME/.grails/wrapper
  - cp /home/travis/build/grails/grails-profiles-tests/build/grails-wrapper/wrapper/build/libs/grails4-wrapper-1.0.1.BUILD-SNAPSHOT.jar $HOME/.grails/wrapper/grails4-wrapper.jar
  - sdk install grails dev /home/travis/build/grails/grails-profiles-tests/build/grails-core
  - sdk install grails
  - sdk use grails dev
  - grails --version
  - grails create-app demo --profile=org.grails.profiles:web:4.0.0.BUILD-SNAPSHOT
  - cd demo
  - touch settings.gradle
  - ./grailsw create-controller Book
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
